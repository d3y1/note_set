# Set proxy on Ubuntu terminal

1. 以管理员身份运行powershell, 下面命令用于开放主系统windows对wsl2的局域网访问权限 wsl2 -> win10 -> internet (allow)
    ```powershell
    PS C:\Users\admin> New-NetFirewallRule -DisplayName "WSL" -Direction Inbound  -InterfaceAlias "vEthernet (WSL)"  -Action Allow
    ```
    如果成功你应该可以在 **设置 | 防火墙 | 高级设置 | 入站规则** 中看到
   
2. 进入 **clash for windows | 主页**, 开启 **允许局域网**
3. 配置 **.zshrc** (Ubuntu-24.04)
   ```shell
   ➜  ~ vi .zshrc
   
   # terminal proxy
   # export hostip -> gnutls_handshake() failed: The TLS connection was non-properly terminated
   export hostip=$(cat /etc/resolv.conf |grep -oP '(?<=nameserver\ ).*')
   alias setproxy='export http_proxy="http://${hostip}:7890";export https_proxy="https://${hostip}:7890";export all_proxy="socks5://${hostip}:7890";'
   alias disproxy='unset http_proxy https_proxy all_proxy'
   
   ➜  ~ source .zshrc
   
   ➜  ~ curl www.google.com
   ➜  ~ curl www.google.com.hk
   ➜  ~ 
   ➜  ~ setproxy
   ➜  ~ curl www.google.com
   ➜  ~ curl www.google.com.hk
   ➜  ~ disproxy
   
   ➜  ~ cat /etc/resolv.conf
   # This file was automatically generated by WSL. To stop automatic generation of this file, add the following entry to /etc/wsl.conf:
   # [network]
   # generateResolvConf = false
   nameserver 172.29.192.1
   ```
    {collapsible="true" collapsed-title="ubuntu terminal proxy configs" default-state="expanded"}
